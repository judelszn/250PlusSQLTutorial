-- Business scenario Q116 - Drought BreakersUSE WorldCup;WITH PreviousParticipation AS (	SELECT M.Home_Team_Name AS Team		, M.Year	FROM WC.WorldCupMatches M	GROUP BY M.Home_Team_Name, M.Year	UNION	SELECT M.Away_Team_Name AS Team		, M.Year	FROM WC.WorldCupMatches M	GROUP BY M.Away_Team_Name, M.Year	), RankedParticipation AS (	SELECT P.Team		, P.Year		, LEAD(P.Year, 3) OVER(PARTITION BY P.Team ORDER BY P.Year) AS ThirdNextYear	FROM PreviousParticipation P	)SELECT R.TeamFROM RankedParticipation RWHERE R.ThirdNextYear - R.Year > 12AND EXISTS (SELECT 1			FROM WC.WorldCupMatches M			WHERE M.Year = (SELECT MAX(M.Year)							FROM WC.WorldCupMatches M								)			AND (R.Team = M.Home_Team_Name OR R.Team = M.Away_Team_Name)			);USE UEFA;-- Business scenario Q117 - Top Team by Home VictoriesSELECT TOP 1 T.TEAM_NAME	, COUNT(*) AS HomeWinsFROM UCL.Matches MINNER JOIN UCL.Teams T ON M.HOME_TEAM_ID = T.TEAM_IDWHERE M.SEASON = '2021-2022' AND M.HOME_TEAM_SCORE > M.AWAY_TEAM_SCOREGROUP BY T.TEAM_NAMEORDER BY COUNT(*) DESC;-- Business scenario Q118 - Largest Stadium by CapacitySELECT TOP 1 S.NAME AS StadiumName	, S.CITY AS City	, S.COUNTRY AS Country	, S.CAPACITY AS StadiumCapacityFROM UCL.Stadiums SORDER BY S.CAPACITY DESC;-- Business scenario Q119 - Most Games ManagedSELECT TOP 1 CONCAT(MG.FIRST_NAME, ' ', MG.LAST_NAME) AS ManagerFullName	, COUNT(*) AS GamesManagedFROM UCL.Matches MINNER JOIN UCL.Teams T ON M.HOME_TEAM_ID = T.TEAM_ID OR M.AWAY_TEAM_ID = T.TEAM_IDINNER JOIN UCL.Managers MG ON T.TEAM_ID = MG.TEAMWHERE M.SEASON = '2021-2022'GROUP BY MG.FIRST_NAME, MG.LAST_NAMEORDER BY COUNT(*) DESC;-- Business scenario Q120 - Youngest Manager in the LeagueSELECT TOP 1 CONCAT(MG.FIRST_NAME, ' ', MG.LAST_NAME) AS ManagerFullName	, MG.DOB AS DateOfBirth	, MG.NATIONALITY AS NationalityFROM UCL.Matches MINNER JOIN UCL.Teams T ON M.HOME_TEAM_ID = T.TEAM_ID OR M.AWAY_TEAM_ID = T.TEAM_IDINNER JOIN UCL.Managers MG ON T.TEAM_ID = MG.TEAMWHERE M.SEASON = '2021-2022'GROUP BY MG.FIRST_NAME, MG.LAST_NAME,MG.DOB, MG.NATIONALITYORDER BY MG.DOB DESC;