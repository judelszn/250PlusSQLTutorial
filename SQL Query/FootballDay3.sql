-- Business scenario Q11 - Analysis of Regular Play GoalsUSE SOCCER_DB;SELECT GD.match_no	, COUNT(GD.goal_id) AS GoalCountFROM dbo.goal_details GDWHERE GD.goal_type = 'N' AND GD.goal_schedule = 'NT'AND GD.match_no IN (	SELECT MM.match_no	FROM dbo.match_mast MM	WHERE MM.play_date LIKE '2016%'	)GROUP BY GD.match_noORDER BY GD.match_no;-- Business scenario Q12 - Matches Without First-Half StoppageSELECT MM.match_no	, MM.play_date	, COUNT(gd.goal_id) AS GoalCountFROM dbo.match_mast MMLEFT JOIN dbo.goal_details GD ON MM.match_no = GD.match_noWHERE MM.stop1_sec = 0 AND MM.play_date LIKE '2016%' AND GD.goal_schedule = 'NT'GROUP BY MM.match_no, MM.play_dateORDER BY MM.match_no;-- Business scenario Q13 - Goalless Group Stage MatchesSELECT COUNT(DISTINCT M.match_no) AS GoallessDrawMatchesFROM dbo.match_mast MLEFT JOIN dbo.goal_details GON M.match_no = G.match_noWHERE M.play_date LIKE '2016%' AND M.play_stage = 'G' AND G.goal_id IS NULL AND M.results = 'DRAW';-- Business scenario Q14 - Narrow VictoriesSELECT COUNT(DISTINCT M.match_no) AS OneGoalWinMatchesFROM DBO.match_mast MJOIN dbo.goal_details GON M.match_no = G.match_noWHERE M.results = 'WIN' AND M.decided_by <> 'P' AND M.play_date LIKE '2016%'GROUP BY M.match_noHAVING COUNT(G.goal_id) = 1;-- Business scenario Q15 - Analysis of Total SubstitutionsSELECT COUNT(*) AS NormalTimeSubstitutionCount FROM dbo.player_in_out PWHERE P.play_schedule = 'NT'AND P.match_no IN (	SELECT M.match_no	FROM dbo.match_mast M	WHERE M.play_date LIKE '2016%'	);