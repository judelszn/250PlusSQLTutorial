-- Business scenario Q246 - Employee Performance EvaluationSELECT E.EmployeeKey	, CONCAT(E.FirstName, ' ', E.LastName) AS EmployeeFullName	, YEAR(FS.DueDate) AS EvaluationYear	, MONTH(FS.DueDate) AS EvaluationMonth	, SUM(FS.SalesAmount) AS TotalSalesAmountFROM dbo.DimEmployee EINNER JOIN dbo.FactInternetSales FS ON E.SalesTerritoryKey = FS.SalesTerritoryKeyWHERE YEAR(FS.DueDate) = 2012GROUP BY E.EmployeeKey, E.FirstName, E.LastName, YEAR(FS.DueDate), MONTH(FS.DueDate)ORDER BY SUM(FS.SalesAmount) DESC;-- Business scenario Q247 - Product Sales Performance Analysis by Category and SubcategorySELECT DC.ProductCategoryKey	, DS.ProductSubcategoryKey	, YEAR(FS.OrderDate) AS SalesYear	, SUM(FS.SalesAmount) AS TotalSalesAmountFROM dbo.FactInternetSales FSINNER JOIN dbo.DimProduct DP ON FS.ProductKey = DP.ProductKeyINNER JOIN dbo.DimProductSubcategory DS ON DP.ProductSubcategoryKey = DS.ProductSubcategoryKeyINNER JOIN dbo.DimProductCategory DC ON DS.ProductCategoryKey = DC.ProductCategoryKeyGROUP BY DC.ProductCategoryKey, DS.ProductSubcategoryKey, YEAR(FS.OrderDate)ORDER BY YEAR(FS.OrderDate), SUM(FS.SalesAmount) DESC;-- Business scenario Q248 - Product Sales Analysis by Region for a Specific YearDECLARE @AnalysisYear INT = 2012SELECT G.EnglishCountryRegionName	, SUM(FS.SalesAmount) AS TotalSalesAmountFROM dbo.FactInternetSales FSINNER JOIN dbo.DimDate D ON FS.OrderDateKey = D.DateKeyINNER JOIN dbo.DimGeography G ON FS.SalesTerritoryKey = G.SalesTerritoryKeyWHERE DATEPART(YEAR, D.FullDateAlternateKey) = @AnalysisYearGROUP BY G.EnglishCountryRegionNameORDER BY SUM(FS.SalesAmount) DESC;-- Business scenario Q249 - Sales Analysis by Product Category for a Specific PeriodDECLARE @StartDate DATE = '2012-01-01';DECLARE @EndDate DATE = '2013-12-31';SELECT DC.EnglishProductCategoryName AS ProductCategory	, SUM(FS.SalesAmount) AS TotalSalesAmountFROM dbo.FactInternetSales FSINNER JOIN dbo.DimProduct P ON FS.ProductKey = P.ProductKeyINNER JOIN dbo.DimProductSubcategory DS ON P.ProductSubcategoryKey = DS.ProductSubcategoryKeyINNER JOIN dbo.DimProductCategory DC ON P.ProductSubcategoryKey = DC.ProductCategoryKeyINNER JOIN dbo.DimDate D ON FS.OrderDate = D.DateKeyWHERE D.FullDateAlternateKey BETWEEN '2012-01-01' AND '2013-12-31'GROUP BY DC.EnglishProductCategoryNameORDER BY SUM(FS.SalesAmount) DESC;-- Business scenario Q250 - Sales Performance Analysis for Top Products in Each Territory in 2012DECLARE @Year INT = 2012;WITH RankedProducts AS (	SELECT P.ProductKey		, DT.SalesTerritoryRegion		, P.EnglishProductName AS ProductName		, FS.SalesAmount		, RANK() OVER(PARTITION BY DT.SalesTerritoryRegion ORDER BY FS.SalesAmount) AS RankInTerritory	FROM dbo.FactInternetSales FS	INNER JOIN dbo.DimProduct P ON FS.ProductKey = P.ProductKey	INNER JOIN dbo.DimSalesTerritory DT ON FS.SalesTerritoryKey = DT.SalesTerritoryKey	INNER JOIN dbo.DimDate D ON FS.OrderDate = D.DateKey	WHERE YEAR(D.FullDateAlternateKey) = @Year)SELECT RP.ProductKey	, RP.SalesTerritoryRegion	, RP.ProductName	, RP.SalesAmountFROM RankedProducts RPWHERE RP.RankInTerritory = 1;-- Business scenario Q251 - Promotion AnalysisSELECT P.EnglishPromotionName	, P.StartDate	, P.EndDate	, SUM(FS.SalesAmount) AS TotalSalesAmountFROM dbo.DimPromotion PINNER JOIN dbo.FactInternetSales FS ON P.PromotionKey = FS.PromotionKeyWHERE P.EnglishPromotionName = 'Touring-1000 Promotion'OR P.EnglishPromotionName = 'Touring-3000 Promotion'GROUP BY P.EnglishPromotionName, P.StartDate, P.EndDate;DECLARE @YearOne INT = 2012;SELECT D.FullDateAlternateKey	, YEAR(D.FullDateAlternateKey) AS YEARONEFROM dbo.DimDate DWHERE YEAR(D.FullDateAlternateKey) = @YearOne;