-- Business scenario Q51 - Employee Salary ProjectionSELECT EmployeeID	, JobTitle	, HireDate	, LastDate	, Salary AS CurrentSalary	, Bonus	, CASE 		WHEN DATEDIFF(YEAR,HireDate,GETDATE()) >= 2		AND YEAR(LastDate) BETWEEN 2011 AND 2012		THEN Salary * 1.05		ELSE Salary		END AS FutureSalaryFROM Employee.Pay;-- Business scenario Q52 - Performance Bonus CalculationSELECT EmployeeID	, JobTitle	, HireDate	, LastDate	, Salary AS CurrentSalary	, Bonus	, CASE 		WHEN JobTitle LIKE '$Manager$'		AND YEAR(LastDate) BETWEEN 2011 AND 2012		THEN Salary * 0.1		ELSE Salary * 0.05		END AS PerfomanceBonusFROM Employee.Pay;-- OR SELECT EmployeeID	, JobTitle	, HireDate	, LastDate	, Salary AS CurrentSalary	, Bonus	, CASE 		WHEN JobTitle = 'Manager'		AND YEAR(LastDate) BETWEEN 2011 AND 2012		THEN Salary * 0.1		ELSE Salary * 0.05		END AS PerfomanceBonusFROM Employee.Pay;-- ORSELECT EmployeeID	, JobTitle	, HireDate	, LastDate	, Salary AS CurrentSalary	, Bonus	, CASE 		WHEN JobTitle LIKE '%Manager%'		THEN Salary * 0.1		ELSE Salary * 0.05		END AS PerfomanceBonusFROM Employee.PayWHERE YEAR(LastDate) BETWEEN 2011 AND 2012;-- Business scenario Q53 - Performance Bonus CalculationSELECT EmployeeID	, JobTitle	, HireDate	, LastDate	, Salary AS CurrentSalary	, Bonus AS CurrentBonus	, Salary *	  (CASE 		WHEN MONTH(GETDATE()) = 1 AND JobTitle LIKE '%Manager%' THEN 0.1		WHEN MONTH(GETDATE()) = 7 AND JobTitle NOT LIKE '%Manager%' THEN 0.07		ELSE 0.05		END) AS PerfomanceBonusFROM Employee.Pay;-- Business scenario Q54 - Employee Salary AdjustmentSELECT EmployeeID	, JobTitle	,HireDate	, Salary AS CurrentSalary	, Bonus AS CurrentBonus	, Salary *	(CASE		WHEN DATEDIFF(YEAR,HireDate,GETDATE()) >= 5 AND JobTitle = 'Salesman' THEN 1.10		WHEN DATEDIFF(YEAR,HireDate,GETDATE()) >= 3 AND JobTitle = 'Shipper' THEN 1.05		ELSE Salary		END	) AS SalaryAdjustedFROM Employee.Pay;-- Business scenario Q55 - Overtime Pay CalculationSELECT EmployeeID	, JobTitle	, HireDate	, HourlyRate	, LastDate	, CASE 		WHEN HourlyRate IS NOT NULL AND DATEDIFF(WEEK,HireDate,GETDATE()) > 0		THEN (40 * HourlyRate) + ((CASE WHEN HourlyRate > 0 THEN (HourlyRate * 1.05) ELSE 0 END)		* (DATEDIFF(WEEK,HireDate,GETDATE()) - 1) * 40)		ELSE Salary 		END AS OvertimeFROM Employee.Pay;-- Business scenario Q56 - Vacation Days CalculationSELECT EmployeeID	, JobTitle	, HireDate	, DATEDIFF(YEAR, HireDate, GETDATE()) AS YearOfService	, CASE		WHEN DATEDIFF(YEAR, HireDate, GETDATE()) < 20 THEN 10		ELSE 15		END AS VacationDayAccruedFROM Employee.Pay;-- Business scenario Q57 - Retirement Eligibility CalculationSELECT EmployeeID	, JobTitle	, HireDate	, DATEDIFF(YEAR, HireDate, GETDATE()) AS YearOfService	, CASE		WHEN DATEDIFF(YEAR,HireDate,GETDATE()) >= 20 THEN 'Yes'		ELSE 'No'		END AS DueRetirementFROM Employee.Pay;-- Business scenario Q58 - Date Conversion for ReportingSELECT EmployeeID	, JobTitle	, CONVERT(NVARCHAR(10), HireDate, 120) AS HireDateFormatted	, CONVERT(NVARCHAR(10), LastDate, 120) AS LastDateFormattedFROM Employee.Pay;-- Business scenario Q59 - Employee Anniversary RecognitionSELECT EmployeeID	, CONCAT('Congratulations, "',JobTitle,'", on your ', DATEDIFF(YEAR,HireDate,GETDATE()),	'-year work anniversary with our company!') AS AnniversaryMessageFROM Employee.Pay;-- Business scenario Q60 - Employee Salary and Job InformationSELECT EE.EmployeeID	, EE.FirstName	, EE.LastName	, EE.EmployeeAddress	, EE.Phone	, EP.JobTitle	, EP.HireDate	, EP.Salary	, EP.BonusFROM Employee.Employee EEINNER JOIN Employee.Pay EPON EE.EmployeeID = EP.EmployeeID;