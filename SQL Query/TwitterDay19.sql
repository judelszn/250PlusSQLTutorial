USE TwitterDB;

--  Scenario Q37 - Identify Users Who Have Received the Most Likes from Non-FollowersSELECT T.UserID	, U.Username	, U.FullName	, COUNT(DISTINCT L.UserID) AS NonFollowersLikesCountFROM Twitter.Tweets TINNER JOIN Twitter.Likes L ON T.TweetID = L.TweetIDLEFT JOIN Twitter.Followers F ON T.UserID = F.FollowedUserID AND L.UserID = F.FollowerUserIDINNER JOIN Twitter.Users U ON T.UserID = U.UserIDWHERE F.FollowerUserID IS NULLGROUP BY T.UserID, U.Username, U.FullNameORDER BY COUNT(DISTINCT L.UserID) DESCOFFSET 0 ROWSFETCH NEXT 3 ROWS ONLY;-- Scenario Q38 - Find Users Who Have Sent the Most Direct Messages Containing a Specific KeywordSELECT M.SenderID	, U.Username	, U.FullName	, COUNT(*) AS MessageCountFROM Twitter.Users UINNER JOIN Twitter.DirectMessages M ON U.UserID = M.SenderIDWHERE M.MessageText LIKE '%offer%'GROUP BY M.SenderID, U.Username, U.FullNameORDER BY COUNT(*) DESCOFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY ;